<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Game Luy·ªán Chu·ªôt PRO</title>
<style>
  body {
    background: #111;
    color: white;
    text-align: center;
    font-family: Arial;
  }
  canvas {
    background: #222;
    cursor: none; /* ·∫©n chu·ªôt m·∫∑c ƒë·ªãnh */
  }
</style>
</head>
<body>

<h2>üéØ Game Luy·ªán Chu·ªôt</h2>
<p>‚è± <span id="time">30</span>s | ‚≠ê <span id="score">0</span></p>

<canvas id="game" width="700" height="400"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const scoreEl = document.getElementById("score");
const timeEl = document.getElementById("time");

let bubbles = [];
let score = 0;
let time = 30;
let gameOver = false;

// chu·ªôt custom
let mouse = { x: 0, y: 0 };

canvas.addEventListener("mousemove", e => {
  const rect = canvas.getBoundingClientRect();
  mouse.x = e.clientX - rect.left;
  mouse.y = e.clientY - rect.top;
});

function createBubble() {
  return {
    x: Math.random() * 650 + 25,
    y: Math.random() * 350 + 25,
    r: 20,
    alpha: 0,      // ƒë·ªô m·ªù
    life: 0        // tu·ªïi ƒë·ªùi
  };
}

function spawnBubbles() {
  let amount = Math.min(6, 2 + Math.floor(score / 5));
  for (let i = 0; i < amount; i++) {
    bubbles.push(createBubble());
  }
}

function update() {
  if (gameOver) return;
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  bubbles.forEach((b, i) => {
    b.life++;

    // fade in
    if (b.life < 20) b.alpha += 0.05;

    // fade out
    if (b.life > 60) b.alpha -= 0.05;

    if (b.alpha <= 0) {
      bubbles.splice(i, 1);
      return;
    }

    ctx.globalAlpha = b.alpha;
    ctx.beginPath();
    ctx.arc(b.x, b.y, b.r, 0, Math.PI * 2);
    ctx.fillStyle = "deepskyblue";
    ctx.fill();
    ctx.globalAlpha = 1;
  });

  // v·∫Ω chu·ªôt custom
  ctx.beginPath();
  ctx.arc(mouse.x, mouse.y, 6, 0, Math.PI * 2);
  ctx.fillStyle = "yellow";
  ctx.fill();

  requestAnimationFrame(update);
}

canvas.addEventListener("click", e => {
  const rect = canvas.getBoundingClientRect();
  const mx = e.clientX - rect.left;
  const my = e.clientY - rect.top;

  bubbles.forEach((b, i) => {
    const dx = mx - b.x;
    const dy = my - b.y;
    if (Math.sqrt(dx*dx + dy*dy) < b.r) {
      score++;
      scoreEl.textContent = score;
      bubbles.splice(i, 1);
    }
  });
});

// t·∫°o bong b√≥ng nhanh d·∫ßn
let spawn = setInterval(spawnBubbles, 700);

// th·ªùi gian
let timer = setInterval(() => {
  time--;
  timeEl.textContent = time;
  if (time <= 0) {
    gameOver = true;
    clearInterval(timer);
    clearInterval(spawn);
    alert("H·∫øt gi·ªù! ƒêi·ªÉm: " + score);
  }
}, 1000);

update();
</script>

</body>
</html>
