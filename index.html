<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Game Luyá»‡n Chuá»™t</title>
<style>
body {
  background:#111;
  color:white;
  text-align:center;
  font-family:Arial;
}
canvas {
  background:#222;
  cursor:none;
   display: block;
  margin: 0 auto;
}
button {
  padding:10px 20px;
  margin:5px;
  font-size:16px;
  cursor:pointer;
}
#menu { margin-top:40px; }
</style>
</head>
<body>

<h2>ğŸ¯ Game Luyá»‡n Chuá»™t</h2>

<div id="menu">
  <p>ğŸ® Chá»n cháº¿ Ä‘á»™</p>
  <button onclick="startGame(30)">Dá»… (30s)</button>
  <button onclick="startGame(20)">KhÃ³ (20s)</button>
  <button onclick="startGame(10)">SiÃªu khÃ³ (10s)</button>
</div>

<p id="info" style="display:none;">
â± <span id="time"></span>s | â­ <span id="score">0</span>
</p>

<canvas id="game" width="700" height="400" style="display:none;"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const scoreEl = document.getElementById("score");
const timeEl = document.getElementById("time");
const menu = document.getElementById("menu");
const info = document.getElementById("info");

let bubbles = [];
let score = 0;
let time = 0;
let gameOver = false;
let spawnInterval;
let timer;

let mouse = {x:0,y:0};

canvas.addEventListener("mousemove", e=>{
  const r = canvas.getBoundingClientRect();
  mouse.x = e.clientX - r.left;
  mouse.y = e.clientY - r.top;
});

function createBubble(){
  return {
    x:Math.random()*650+25,
    y:Math.random()*350+25,
    r:20,
    alpha:0,
    life:0
  };
}

function spawnBubbles(){
  let amount = Math.min(6,2+Math.floor(score/5));
  for(let i=0;i<amount;i++){
    bubbles.push(createBubble());
  }
}

function update(){
  if(gameOver) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  bubbles.forEach((b,i)=>{
    b.life++;

    // fade cháº­m
    if(b.life<30) b.alpha+=0.03;
    if(b.life>90) b.alpha-=0.03;

    if(b.alpha<=0){
      bubbles.splice(i,1);
      return;
    }

    ctx.globalAlpha=b.alpha;
    ctx.beginPath();
    ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
    ctx.fillStyle="deepskyblue";
    ctx.fill();
    ctx.globalAlpha=1;
  });

  // chuá»™t
  ctx.beginPath();
  ctx.arc(mouse.x,mouse.y,6,0,Math.PI*2);
  ctx.fillStyle="yellow";
  ctx.fill();

  requestAnimationFrame(update);
}

canvas.addEventListener("click",e=>{
  const r=canvas.getBoundingClientRect();
  const mx=e.clientX-r.left;
  const my=e.clientY-r.top;

  bubbles.forEach((b,i)=>{
    const dx=mx-b.x;
    const dy=my-b.y;
    if(Math.sqrt(dx*dx+dy*dy)<b.r){
      score++;
      scoreEl.textContent=score;
      bubbles.splice(i,1);
    }
  });
});

function startGame(t){
  menu.style.display="none";
  canvas.style.display="block";
  info.style.display="block";

  score=0;
  time=t;
  bubbles=[];
  gameOver=false;
  scoreEl.textContent=0;
  timeEl.textContent=time;

  spawnInterval=setInterval(spawnBubbles,700);

  timer=setInterval(()=>{
    time--;
    timeEl.textContent=time;
    if(time<=0){
      endGame();
    }
  },1000);

  update();
}

function endGame(){
  gameOver=true;
  clearInterval(timer);
  clearInterval(spawnInterval);

  let rank="";
  if(score>=25) rank="ğŸ”¥ Cá»°C KÃŒ Cá»°C KÃŒ PROMAXXX";
  else if(score>=20) rank="ğŸ’ Cá»°C PRO";
  else if(score>=15) rank="ğŸ˜ QUÃ PRO";
  else rank="ğŸ™‚ Táº­p thÃªm nha";

  alert("Háº¿t giá»!\nÄiá»ƒm: "+score+"\nXáº¿p háº¡ng: "+rank);
}
</script>

</body>
</html>
